<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<!-- import CSS -->
		<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
		<link rel="stylesheet" href="./css/index.css">
		<link rel="stylesheet" href="./css/result.css">
		<!-- import Vue before Element -->
		<script src="https://unpkg.com/vue/dist/vue.js"></script>
		<!-- import         JavaScript -->
		<script src="https://unpkg.com/element-ui/lib/index.js"></script>
		<!-- import JQuery -->
		<script src="https://cdn.staticfile.org/jquery/3.1.1/jquery.min.js"></script>
		<script type="text/javascript">
			window.onload
		</script>
	</head>
	<body>
		<div class="searchbar" id="searchbar">
			<el-card class="box-card">
				<div>放logo</div>

					<el-form label-width="20%" :model="info" style="margin-top: 20%;width: 80%">
						<el-form-item label="输入">
							<el-input placeholder="" v-model="info.studentNumber" :disabled="false" style="width: 80%">
							<!-- <i slot="prefix" class="el-input__icon el-icon-user-solid"></i> -->
						</el-form-item>
						<el-button type="primary" @click="search">搜索</el-button>
						<el-button type="primary" @click="search">高级搜索</el-button>
					</el-form>
			</el-card>
		</div>
		<div style="height: 500px;"></div>
		<div class="result_body" id="result">
			<div class="result_card">
				<h2 class="result_title">{{title}}</h2>
				<div class="result_snippet">{{abstract}}</div>
			</div>
			<div class="result_card">
				<h2 class="result_title">测试标题2 Foreign Exchanges: Dollar rises on US indicators</h2>
				<div class="result_snippet">测试正文内容THE DOLLAR staged a recovery in late European trading on the foreign exchange markets yesterday following signs of strong US manufacturing growth last month, writes James Blitz. Potential dollar buyers grew confident after the National Association of Purchasing Management\'s index rose at its fastest pace in almost four years</div>
			</div>
		</div>
	</body>
	<script type="text/javascript">
		var data ={}
		data['title']=localStorage.getItem('title');
		data['abstract']=localStorage.getItem('abstract');;

		new Vue({
			el: '#result',
			data: data
		})
	</script>
	<script>
		new Vue({
			el: '#searchbar',
			data: function() {
				return {
					info: {
						query: '',
					},
					role:'user'
				}
			},
			methods: {
				currRole(selVal){
					this.role = selVal;
					sessionStorage.setItem('role', this.role);
				},
				search(){
					var _self = this;
					$.ajax({
						url: "http://host:30000/search",
						type: 'get',
						dataType: 'json',
						contentType:"application/json",
						data: { info: JSON.stringify(_self.info) },
						success: res => {
							if(res.err == false){
								sessionStorage.setItem('result',res.data.result);
								_self.$message({
									message: 'search success',
									type: 'success',
									center: true
								});
								setTimeout(() => { window.location.href = 'main.html'; }, 1000);
							} else {
								_self.$message({
									message: '用户名或密码错误',
									type: 'error',
									center: true
								});
							}
						},
						error: err =>  console.log(err)
					});
				},
				
			}
		});
	</script>
</html>